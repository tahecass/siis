<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="DetalleCarteraMapper">
	<resultMap id="resMapDetalleCartera" type="DetalleCarteraAlias">
		<result property="secuencia" column="SECUENCIA_DET_CARTERA" />
		<result property="cartera.secuencia" column="SECUENCIA_CARTERA" />
		<result property="cartera.usuario.secuencia" column="SECUENCIA_USUARIO" />
		<result property="cartera.usuario.cuenta" column="CUENTA" />
		
		<result property="cartera.cliente.secuencia" column="SECUENCIA_CLIENTE" />
		<result property="cartera.cliente.nombreRazonSocial" column="NOMBRE_RAZON_SOCIAL" />
		<result property="cartera.cliente.nit" column="NIT" />
		<result property="cartera.fechaPago" column="FECHA_PAGO" />
		<result property="cartera.fechaHoraActualizacion" column="FECHA_HORA_ACTUALIZACION" />
		
		<result property="nroFactura" column="NRO_FACTURA" />
		<result property="valor1" column="VALOR_1" />
		<result property="valor2" column="VALOR_2" />
		<result property="valor3" column="VALOR_3" />
		<result property="valor4" column="VALOR_4" />
		<result property="vencimiento" column="VENCIMIENTO" />
		<result property="referencia" column="REFERENCIA" /> 
		
		 		
	</resultMap>	
	
  
	<select id="guardarDetalleCartera" parameterType="DetalleCarteraAlias" resultMap="resMapDetalleCartera"  > 			  
			  INSERT INTO detalle_cartera
			         ( SECUENCIA, SECUENCIA_CARTERA, VENCIMIENTO, REFERENCIA, NRO_FACTURA, VALOR_FACTURA) 
			  VALUES (1,
			         #{cartera.secuencia,jdbcType=NUMERIC},
			         #{vencimiento,jdbcType=DATE},
			         #{referencia,jdbcType=VARCHAR},
			         #{nroFactura,jdbcType=VARCHAR},
			         #{valor1,jdbcType=NUMERIC},
			         #{valor2,jdbcType=NUMERIC},
			         #{valor3,jdbcType=NUMERIC},
			         #{valor4,jdbcType=NUMERIC}
			         
			         )
		       
	</select>
	<select id="listarDetalleCarterasPorClientes" parameterType="Map" resultMap="resMapDetalleCartera"  > 
		SELECT 
		  "CARTERA"."SECUENCIA" AS "SECUENCIA_CARTERA", 
		  "CARTERA"."FECHA_PAGO", 
		  "CARTERA"."FECHA_HORA_ACTUALIZACION",
		  "CARTERA"."SECUENCIA_USUARIO", 
		  "CARTERA"."SECUENCIA_CLIENTE", 
		  "CLIENTES"."NOMBRE_RAZON_SOCIAL", 
		  "CLIENTES"."NIT", 
		  "CLIENTES"."SECUENCIA_PERSONA", 
		  "USUARIOS"."CUENTA", 
		  "DETALLE_CARTERA"."SECUENCIA" AS "SECUENCIA_DET_CARTERA", 
		  "DETALLE_CARTERA"."SECUENCIA_CARTERA", 
		  "DETALLE_CARTERA"."VENCIMIENTO", 
		  "DETALLE_CARTERA"."REFERENCIA", 
		  "DETALLE_CARTERA"."NRO_FACTURA", 
		  "DETALLE_CARTERA"."VALOR_FACTURA"
		FROM 
		  public."DETALLE_CARTERA"
		  LEFT JOIN  public."CARTERA" ON "CARTERA"."SECUENCIA" = "DETALLE_CARTERA"."SECUENCIA_CARTERA" 
		  LEFT JOIN  public."CLIENTES" ON "CLIENTES"."SECUENCIA" = "CARTERA"."SECUENCIA_CLIENTE" 
		  LEFT JOIN  public."USUARIOS" ON "USUARIOS"."SECUENCIA" = "CARTERA"."SECUENCIA_USUARIO"
		 
		 WHERE  "CARTERA"."SECUENCIA_CLIENTE"= #{SECUENCIA_CLIENTE,jdbcType=NUMERIC};
 </select>
</mapper>


